
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Playbook &#8212; GCP IR Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Discover Cluster (ipynb)" href="playbook/discover_cluster.html" />
    <link rel="prev" title="Container Filesystem" href="bg/container_filesystem.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">GCP IR Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Administration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../admin/svc_acct.html">
   Service Account
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../admin/svc_acct/min_perm_target.html">
     Minimal Role / Permissions for Target
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../admin/svc_acct/min_perm_analyst.html">
     Minimal Role / Permissions for Analyst
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../admin/svc_acct/security_hardening.html">
     Security Hardening
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../admin/vm_instances_for_ir.html">
   VM Instances for IR
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../admin/gcloud_cli_kubectl_cs.html">
   gcloud CLI &amp; kubectl Cheatsheet
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Google Compute Engine (GCE)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../gce/create_4n6_disk_from_snapshot.html">
   Create Disk Snapshot &amp; Forensic Disk (ipynb)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Google Kubernetes Engine (GKE)
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="bg.html">
   Background
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="bg/container_runtime.html">
     Container Runtime
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bg/container_filesystem.html">
     Container Filesystem
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   Playbook
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="playbook/discover_cluster.html">
     Discover Cluster (ipynb)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="playbook/app_logs.html">
     Application Logs
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="playbook/analysis.html">
     Analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="playbook/analysis/live_response.html">
       Live Response
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="playbook/analysis/mount_container_fs.html">
       Mount Container Filesystem
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="playbook/analysis/determine_pod_escape.html">
       Determine Pod Escape (ipynb)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="playbook/containment.html">
     Containment
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Virtual Private Cloud (VPC)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../vpc/packet_capture.html">
   Full Packet Capture (ipynb)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Identity &amp; Access Management (IAM)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../iam/access_tokens.html">
   Access Tokens
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iam/restrict_ip.html">
   Restrict Access by IP
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Log Explorer
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../log_explorer/query_language.html">
   Query Language
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../log_explorer/log_review.html">
   Log Review (ipynb)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../log_explorer/attacker_apis.html">
   Attackers’ APIs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../log_explorer/create_alerts.html">
   Create Alerts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../log_explorer/detections.html">
   Detections
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Silv3rHorn/GCP-IR-Notes"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Silv3rHorn/GCP-IR-Notes/issues/new?title=Issue%20on%20page%20%2Fgke/playbook.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/gke/playbook.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#breakdown">
   Breakdown
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Playbook</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#breakdown">
   Breakdown
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="playbook">
<h1>Playbook<a class="headerlink" href="#playbook" title="Permalink to this headline">#</a></h1>
<div class="full-width docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Kubernetes Dashboard and API server (ports 10250/10255) exposures, and control-plane attacks are unlikely to happen due to GKE’s default security configuration. Hence, they are given little or no focus in this playbook.</p>
</div>
<img alt="../_images/playbook_1.png" id="playbook-1" src="../_images/playbook_1.png" />
<p><strong>References</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/">Threat matrix for Kubernetes</a></p></li>
<li><p><a class="reference external" href="https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/">Secure containerized environments with updated threat matrix for Kubernetes</a></p></li>
</ul>
</div>
<section id="breakdown">
<h2>Breakdown<a class="headerlink" href="#breakdown" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<table class="table">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Phase</p></th>
<th class="head"><p>Activity</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Detection</p></td>
<td><p>Incident escalated involving GKE</p></td>
<td><p><strong>Possible escalation sources:</strong><br />
<strong>SOC</strong> - Detections from use cases<br />
<strong>CTI</strong> - Threat intel reports<br />
<strong>End user</strong> - Unusual activity (e.g. higher billing cost, unfamiliar deployments) noticed<br />
<strong>3rd party</strong> - Found public exposure of sensitive information or unpatched vulnerability
<br/><br/>
If root cause is not known from escalation source, proceed in parallel to <code class="docutils literal notranslate"><span class="pre">Determine</span> <span class="pre">root</span> <span class="pre">cause</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>Analysis</p></td>
<td><p>Identify GCP project, cluster and owner/PIC</p></td>
<td><p><strong>Identify GCP Project &amp; Cluster</strong><br />
One way is to use the <code class="docutils literal notranslate"><span class="pre">Search</span> <span class="pre">products</span> <span class="pre">and</span> <span class="pre">resources</span></code> search in GCP menu bar to search for IP Addresses and Names of resources. Note that the search is limited to only the resources you have access to.
<br/><br/>
<strong>Identify Owner/PIC</strong><br />
One way is to access <a class="reference external" href="https://console.cloud.google.com/iam-admin/iam?project=">https://console.cloud.google.com/iam-admin/iam?project=</a>&lt;project_id&gt; and user account with the role <code class="docutils literal notranslate"><span class="pre">Owner</span></code>
<br/><br/>
Request Owner/PIC to grant the IR team the <a class="reference internal" href="../admin/svc_acct/min_perm_target.html"><span class="doc std std-doc">necessary permissions</span></a> at his/her project and SSH access to the nodes in the GKE cluster under investigation</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Request for preservation of evidence</p></td>
<td><p>Especially important given the self-healing and auto-scaling capabilities of Kubernetes which contributes to the volatility
<br/><br/>
Request Owner/PIC <strong>NOT</strong> to <ul><li>Delete/restart the impacted cluster/deployment/node/pod(s)</li><li>Perform any remediation activities unless it had been cleared by the IR team</li></ul></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Discover cluster</p></td>
<td><p>Refer to <a class="reference internal" href="playbook/discover_cluster.html"><span class="doc std std-doc">Discover Cluster</span></a></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Artifacts [logs] in persistent storage?</p></td>
<td><p>This impacts how the artifacts would be collected for analysis
<br/><br/>
<strong>Potential persistent storage locations:</strong><br />
<code class="docutils literal notranslate"><span class="pre">gcePersistentDisk</span></code> - Google Compute Engine Volume<br />
<code class="docutils literal notranslate"><span class="pre">PersistentVolumeClaim</span></code> - Makes a claim from the cluster for an allocation of persistent storage (provided by a matching <code class="docutils literal notranslate"><span class="pre">PersistentVolume</span></code> object)<br />
<code class="docutils literal notranslate"><span class="pre">hostPath</span></code> - Uses a file or directory on the node to emulate network-attached storage
<br/><br/>
Refer to <a class="reference internal" href="playbook/app_logs.html"><span class="doc std std-doc">Application Logs</span></a></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Acquire persistent storage</p></td>
<td><p>Refer to <a class="reference internal" href="playbook/app_logs.html"><span class="doc std std-doc">Application Logs</span></a></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Acquire <strong>node</strong> persistent storage</p></td>
<td><p>Refer to <a class="reference internal" href="playbook/app_logs.html"><span class="doc std std-doc">Application Logs</span></a></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Perform live response</p></td>
<td><p>Refer to <a class="reference internal" href="playbook/analysis/live_response.html"><span class="doc std std-doc">Live Response</span></a></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Determine root cause</p></td>
<td><p><strong>Compromised Credentials</strong><ul><li>Compromised Google Account</li><li>Access key (e.g. service account key or SSH key) exposed to public</li><li>Adversary obtaining valid kubeconfig file (e.g. via a compromised endpoint) which they can use for accessing the clusters</li></ul>
<strong>Compromised Image</strong><ul><li>Adversary plants their own compromised image(s) in a private registry (e.g. within the GCP project) they obtained access to. These images can then be pulled by a user</li><li>Using untrusted images from public registries (e.g. Docker Hub) that may be malicious</li></ul>
<strong>Unintended Exposure</strong><ul><li>Interfaces that are not intended to be exposed to the Internet, and therefore don’t require (secure) authentication by default. Exposing them to the Internet allows accesses which might enable running code or deploying containers in the cluster by an adversary</li><li>Examples of such interfaces that were seen exploited include Apache NiFi, Kubeflow, Argo Workflows, Weave Scope, and the Kubernetes dashboard</li></ul>
<strong>Vulnerable Application</strong><ul><li>Running an Internet-facing vulnerable application in a cluster can enable initial access to the cluster, especially if it is vulnerable to remote code execution vulnerability (RCE) that may be exploited</li></ul></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Analyse collected artifacts</p></td>
<td><p>Start by <a class="reference internal" href="playbook/analysis/mount_container_fs.html"><span class="doc std std-doc">mounting the container filesystem</span></a></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Determine Impact</p></td>
<td><p><strong>Pod Escape</strong><ul><li>Refer to <a class="reference internal" href="playbook/analysis/determine_pod_escape.html"><span class="doc std std-doc">Determine Pod Escape</span></a></li></ul>
<strong>Data Destruction</strong><ul><li>Adversary may attempt to destroy data and resources in the cluster. This includes deleting deployments, configurations, storage and compute resources</li></ul>
<strong>Resource Hijacking</strong><ul><li>Adversary may abuse a compromised resource (e.g. pod) for running tasks such as cryptocurrency mining</li><li>Adversary may also create new pods for such activities</li></ul>
<strong>Denial of Service</strong><ul><li>Includes attempts to block the availability of the pods themselves, the underlying nodes, or the API server</li></ul>
<strong>Exfiltration</strong><ul><li>Adversary may attempt to extract and steal data that is being processed or stored by cluster resources</li></ul></p></td>
</tr>
<tr class="row-odd"><td><p>Containment</p></td>
<td><p>Compromised Credentials | Revoke access and/or disable/reset credentials</p></td>
<td><p><strong>Google Account</strong> - Follow your company’s Account Compromise playbook<br />
<strong>Access Key</strong> - Follow your company’s Key Exposure playbook<br />
<strong>kubeconfig</strong> - <a class="reference external" href="../iam/access_tokens.html#revoke-access-tokens">Revoke access (and refresh token)</a> in <code class="docutils literal notranslate"><span class="pre">kubeconfig</span></code></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Compromised Image | Isolate the resource and take down the image</p></td>
<td><p>Refer to <a class="reference internal" href="playbook/containment.html"><span class="doc std std-doc">Containment</span></a>
<br/><br/>
<strong>Take down the image</strong><ul><li>Public registry - Request take down (e.g. <a class="reference external" href="https://github.com/docker/hub-feedback/issues">Docker Hub</a>)</li><li>Private registry (e.g. within Project) - Refer to <a class="reference external" href="https://cloud.google.com/container-registry/docs/managing#deleting_images">Container Registry Documentation</a></li></ul></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Unintended Exposure | Close the exposure</p></td>
<td><p>Depending on the type of exposure, consider the following steps<ul><li>Rectify the ACL of the resource</li><li>Close/Filter the exposed network port</li><li>Implement secure authentication (e.g. MFA, PKI)</li></ul></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Vulnerable Application | Isolate the resource and take down the application</p></td>
<td><p>Refer to <a class="reference internal" href="playbook/containment.html"><span class="doc std std-doc">Containment</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Remediation / Eradication</p></td>
<td><p>Remove any persistence</p></td>
<td><p>Based on persistence mechanisms identified during analysis</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Reset other credentials accessed by adversary</p></td>
<td><p><strong>Google Account</strong> - Follow your company’s Account Compromise playbook<br />
<strong>Access Key</strong> - Follow your company’s Key Exposure playbook</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Patch any exploited vulnerabilities</p></td>
<td><p>Download patches and apply them according to vendor’s advisories / instructions</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Reset unauthorised modifications</p></td>
<td><p>Based on analysis performed, and includes all impacted resources</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./gke"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="bg/container_filesystem.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Container Filesystem</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="playbook/discover_cluster.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Discover Cluster (ipynb)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Silv3rHorn<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>